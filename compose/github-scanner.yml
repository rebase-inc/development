version: '2'
volumes:
    log: {}

services:
  github_scanner:
    container_name: github_scanner
    hostname: github_scanner
    image: github_scanner
    build:
      context: ../services/github-scanner
      args:
        PYTHON_COMMONS_SCHEME: '${PYTHON_COMMONS_SCHEME}'
        PYTHON_COMMONS_HOST: '${PYTHON_COMMONS_HOST}'
        PYTHON_COMMONS_PORT: '${PYTHON_COMMONS_PORT}'
    environment:
      BREADTH_IMPORTANCE: 4
      GITHUB_CRAWLER_USERNAME: '${GITHUB_CRAWLER_USERNAME}'
      GITHUB_CRAWLER_PASSWORD: '${GITHUB_CRAWLER_PASSWORD}'
      S3_BUCKET: '${S3_KNOWLEDGE_BUCKET}'
      TMPFS_DRIVE_MAX_WRITE: 262144000 # 250M
      TMPFS_DRIVE: '/repos'
      LARGE_DRIVE: '/bigrepos'
      AWS_REGION: '${AWS_REGION}'
      AWS_ACCESS_KEY_ID: '${AWS_ACCESS_KEY_ID}'
      AWS_SECRET_ACCESS_KEY: '${AWS_SECRET_ACCESS_KEY}'
    tmpfs:
     - /repos:rw,noexec,size=500m
