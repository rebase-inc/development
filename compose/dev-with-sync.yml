version: '2'
volumes:
  SYNC_api:
    external: true
  SYNC_pypi_server:
    external: true
  SYNC_private_crawler:
    external: true
  SYNC_population_analyzer:
    external: true
  SYNC_javascript_impact:
    external: true
  SYNC_python_impact:
    external: true

services:
  api:
    volumes:
      - SYNC_api:/usr/app/src
      - SYNC_pypi_server:/usr/app/site-packages
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
      CONFIG: '/usr/app/src/conf/gunicorn.dev.conf'
  private_crawler:
    volumes:
      - SYNC_private_crawler:/usr/app/src
      - SYNC_pypi_server:/usr/app/site-packages
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
  population_analyzer:
    volumes:
      - SYNC_population_analyzer:/usr/app/src
      - SYNC_pypi_server:/usr/app/site-packages
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
  python_parser:
    volumes:
      - SYNC_pypi_server:/usr/app/site-packages
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
    ports:
      - "25252:25252"
  python_2_parser:
    volumes:
      - SYNC_pypi_server:/usr/app/site-packages
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
    ports:
      - "25253:25253"
  javascript_parser:
    ports:
      - "7777:7777"
    environment:
      LOG_LEVEL: 'DEBUG'
  rq_dashboard:
    extends:
      file: rq-dashboard.yml
      service: rq_dashboard
    ports:
      - "4444:4444"
  python_impact:
    volumes:
      - SYNC_pypi_server:/usr/app/site-packages
      - SYNC_python_impact:/usr/app/src
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
    ports:
      - "25000:25000"
  javascript_impact:
    volumes:
      - SYNC_pypi_server:/usr/app/site-packages
      - SYNC_javascript_impact:/usr/app/src
    environment:
      LOG_LEVEL: 'DEBUG'
      PYTHONPATH: '/usr/app/src:/usr/app/site-packages'
    ports:
      - "9999:9999"
  database:
    ports:
      - "5432:5432"
